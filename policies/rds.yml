# Rational Database Service (RDS) Policies

policies:

####################################
#####    Compliance Policies   #####
####################################

- name: require-rds-encrypt-and-non-public
  resource: rds
  mode:
    - type: cloudtrail
    - events:
      - CreateDBInstance
  filters:
    - or:
      - Encrypted: false
      - PubliclyAvailable: true
  actions:
    - type: delete
      skip-snapshot: true


- name: rds-prd-multi-az-remediate
  resource: rds
  description: |
    Notify on all Prod RDS Instances that are Not Multi AZ setup.
  mode:
    type: cloudtrail
    events:
      - source: rds.amazonaws.com
        event: CreateDBInstance
        ids: "requestParameters.dBInstanceIdentifier"
  filters:
    - type: value
      key: 'tag:Environment'
      value: '^pro?d'
      op: regex
    - MultiAZ: false
  #actions:   

######################################
#####    Cost Savings Policies   #####
######################################

################################
#####    Backup Policies   #####
################################  